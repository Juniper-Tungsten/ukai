- define:
    name: create_resources
    args:
      transaction: object
      resources: object
    body:
    - db_create:
        tx: $transaction
        schema_id: $item.key
        data: $item.value
      with_dict: $resources
- define:
    name: setup_resources
    args:
      db: object
    body:
    - vars:
        resources:
        - id_pool:
            id: pool1
            start: 1000
            end: 1002
            name: route_target
            assigned: false
        - id_pool:
            id: pool2
            start: 1000
            end: 1002
            name: security_group
            assigned: false
        - network:
            id: 6bfafb2a-bc4b-4655-a5a6-8b760df60e16
            name: blue
            tenant_id: admin
        - network:
            id: 6369c8f8-8d9c-4e5e-b632-a724a6b2ffe1
            name: red
            tenant_id: admin
        - location:
            id: tokyo
            name: tokyo
            tenant_id: admin
            keystone_endpoint: http://10.84.34.96:35357/v2.0
            contrail_endpoint: http://10.84.34.96:8082
            region: RegionOne
        - location:
            id: sf
            name: sf
            tenant_id: admin
            keystone_endpoint: http://10.84.34.76:35357/v2.0
            contrail_endpoint: http://10.84.34.76:8082
            region: RegionOne
        - local_network:
            id: d420e29e-2cd9-44aa-b464-daaa4080dfea
            name: blue_subnet1
            cidr: 10.0.0.0/24
            tenant_id: admin
            network_id: 6bfafb2a-bc4b-4655-a5a6-8b760df60e16
            location_id: tokyo
        - local_network:
            id: 11aa9c38-b91c-4107-a6b7-261d99cc50ea
            name: blue_subnet2
            cidr: 11.0.0.0/24
            tenant_id: admin
            network_id: 6bfafb2a-bc4b-4655-a5a6-8b760df60e16
            location_id: sf
        - local_network:
            id: 3c0da5b7-605d-4ada-b85a-0c1167c19fc6
            name: red_subnet1
            cidr: 20.0.0.0/24
            tenant_id: admin
            network_id: 6369c8f8-8d9c-4e5e-b632-a724a6b2ffe1
            location_id: tokyo
        - local_network:
            id: b585a27f-fb63-485f-915e-ff1b4f26e5aa
            name: red_subnet2
            cidr: 21.0.0.0/24
            tenant_id: admin
            network_id: 6369c8f8-8d9c-4e5e-b632-a724a6b2ffe1
            location_id: sf
        - security_group:
              id: 081b50d0-c6e0-11e5-a837-0800200c9a66
              name: security_group1
              tenant_id: admin
    - transaction:
      - create_resources:
          transaction: $transaction
          resources: $item
        with_items: $resources
